{"ast":null,"code":"import \"isomorphic-unfetch\";\nconst API_URL = \"https://graphql.datocms.com\";\nconst API_TOKEN = process.env.NEXT_EXAMPLE_CMS_DATOCMS_API_TOKEN; // See: https://www.datocms.com/blog/offer-responsive-progressive-lqip-images-in-2020\n\nconst RESPONSIVE_IMAGE_FRAGMENT = `\n  height\n  sizes\n  src\n  srcSet\n  width\n  alt\n  title\n`;\nconst META_TAGS_FRAGMENT = `\n  attributes\n  content\n  tag\n`;\n\nasync function fetchAPI(query, {\n  variables,\n  preview\n} = {}) {\n  console.log(query, variables);\n  const res = await fetch(API_URL + (preview ? \"/preview\" : \"\"), {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${API_TOKEN}`\n    },\n    body: JSON.stringify({\n      query,\n      variables\n    })\n  });\n  const json = await res.json();\n\n  if (json.errors) {\n    console.error(json.errors);\n    throw new Error(\"Failed to fetch API\");\n  }\n\n  return json.data;\n}\n\nexport async function getPostDataById(id) {\n  const query = `\n    query PostById($id: ItemId) {\n      article(filter: {id: {eq: $id}}) {\n        createdAt\n        content {\n          ... on PostRecord {\n            id\n            title\n            slug\n            author\n            postContent(markdown: true)\n            excerpt\n            tableOfContents\n            createdAt\n            coverImage {\n              responsiveImage(imgixParams: { fit: crop, ar: \"16:9\", w: 750 }) {\n                ${RESPONSIVE_IMAGE_FRAGMENT}\n              }\n            }\n          }\n        }\n      }\n    }`;\n  const data = await fetchAPI(query, {\n    variables: {\n      id\n    }\n  });\n  return data === null || data === void 0 ? void 0 : data.article;\n}\nexport async function getAllPostsWithId() {\n  const data = await fetchAPI(`\n    {\n      allArticles {\n        content {\n          id\n        }\n      }\n    }\n  `);\n  return data === null || data === void 0 ? void 0 : data.allArticles;\n}\nexport async function getAllPostsForHome(preview) {\n  const data = await fetchAPI(`\n    {\n      allArticles {\n        content {\n          ... on PostRecord {\n            id\n            title\n            slug\n            author\n            postContent(markdown: true)\n            excerpt\n            tableOfContents\n            createdAt\n            coverImage {\n              responsiveImage(imgixParams: { fit: crop, ar: \"16:9\", w: 750 }) {\n                ${RESPONSIVE_IMAGE_FRAGMENT}\n              }\n            }\n          }\n        }\n      }\n    }\n  `);\n  return data === null || data === void 0 ? void 0 : data.allArticles;\n} // export async function getPostAndMorePosts(slug, preview) {\n//   const data = await fetchAPI(\n//     `\n//   query PostBySlug($slug: String) {\n//     post(filter: {slug: {eq: $slug}}) {\n//       title\n//       slug\n//       content\n//       date\n//       ogImage: coverImage{\n//         url(imgixParams: {fm: jpg, fit: crop, w: 2000, h: 1000 })\n//       }\n//       coverImage {\n//         responsiveImage(imgixParams: {fm: jpg, fit: crop, w: 2000, h: 1000 }) {\n//           ...responsiveImageFragment\n//         }\n//       }\n//       author {\n//         name\n//         picture {\n//           url(imgixParams: {fm: jpg, fit: crop, w: 100, h: 100, sat: -100})\n//         }\n//       }\n//     }\n//     morePosts: allPosts(orderBy: date_DESC, first: 2, filter: {slug: {neq: $slug}}) {\n//       title\n//       slug\n//       excerpt\n//       date\n//       coverImage {\n//         responsiveImage(imgixParams: {fm: jpg, fit: crop, w: 2000, h: 1000 }) {\n//           ...responsiveImageFragment\n//         }\n//       }\n//       author {\n//         name\n//         picture {\n//           url(imgixParams: {fm: jpg, fit: crop, w: 100, h: 100, sat: -100})\n//         }\n//       }\n//     }\n//   }\n//   ${RESPONSIVE_IMAGE_FRAGMENT}\n//   `,\n//     {\n//       preview,\n//       variables: {\n//         slug\n//       }\n//     }\n//   );\n//   return data;\n// }","map":{"version":3,"sources":["/Users/helmutp/Desktop/DEV/playground/personal-blog/lib/api.js"],"names":["API_URL","API_TOKEN","process","env","NEXT_EXAMPLE_CMS_DATOCMS_API_TOKEN","RESPONSIVE_IMAGE_FRAGMENT","META_TAGS_FRAGMENT","fetchAPI","query","variables","preview","console","log","res","fetch","method","headers","Authorization","body","JSON","stringify","json","errors","error","Error","data","getPostDataById","id","article","getAllPostsWithId","allArticles","getAllPostsForHome"],"mappings":"AAAA,OAAO,oBAAP;AAEA,MAAMA,OAAO,GAAG,6BAAhB;AACA,MAAMC,SAAS,GAAGC,OAAO,CAACC,GAAR,CAAYC,kCAA9B,C,CAEA;;AACA,MAAMC,yBAAyB,GAAI;;;;;;;;CAAnC;AAUA,MAAMC,kBAAkB,GAAI;;;;CAA5B;;AAMA,eAAeC,QAAf,CAAwBC,KAAxB,EAA+B;AAAEC,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAAyB,EAAxD,EAA4D;AAC1DC,EAAAA,OAAO,CAACC,GAAR,CAAYJ,KAAZ,EAAmBC,SAAnB;AACA,QAAMI,GAAG,GAAG,MAAMC,KAAK,CAACd,OAAO,IAAIU,OAAO,GAAG,UAAH,GAAgB,EAA3B,CAAR,EAAwC;AAC7DK,IAAAA,MAAM,EAAE,MADqD;AAE7DC,IAAAA,OAAO,EAAE;AACP,sBAAgB,kBADT;AAEPC,MAAAA,aAAa,EAAG,UAAShB,SAAU;AAF5B,KAFoD;AAM7DiB,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBZ,MAAAA,KADmB;AAEnBC,MAAAA;AAFmB,KAAf;AANuD,GAAxC,CAAvB;AAYA,QAAMY,IAAI,GAAG,MAAMR,GAAG,CAACQ,IAAJ,EAAnB;;AACA,MAAIA,IAAI,CAACC,MAAT,EAAiB;AACfX,IAAAA,OAAO,CAACY,KAAR,CAAcF,IAAI,CAACC,MAAnB;AACA,UAAM,IAAIE,KAAJ,CAAU,qBAAV,CAAN;AACD;;AACD,SAAOH,IAAI,CAACI,IAAZ;AACD;;AAED,OAAO,eAAeC,eAAf,CAA+BC,EAA/B,EAAmC;AACxC,QAAMnB,KAAK,GAAI;;;;;;;;;;;;;;;;kBAgBCH,yBAA0B;;;;;;MAhB1C;AAuBA,QAAMoB,IAAI,GAAG,MAAMlB,QAAQ,CAACC,KAAD,EAAQ;AACjCC,IAAAA,SAAS,EAAE;AACTkB,MAAAA;AADS;AADsB,GAAR,CAA3B;AAMA,SAAOF,IAAP,aAAOA,IAAP,uBAAOA,IAAI,CAAEG,OAAb;AACD;AAED,OAAO,eAAeC,iBAAf,GAAmC;AACxC,QAAMJ,IAAI,GAAG,MAAMlB,QAAQ,CAAE;;;;;;;;GAAF,CAA3B;AAUA,SAAOkB,IAAP,aAAOA,IAAP,uBAAOA,IAAI,CAAEK,WAAb;AACD;AAED,OAAO,eAAeC,kBAAf,CAAkCrB,OAAlC,EAA2C;AAChD,QAAMe,IAAI,GAAG,MAAMlB,QAAQ,CACxB;;;;;;;;;;;;;;;kBAeaF,yBAA0B;;;;;;;GAhBf,CAA3B;AA0BA,SAAOoB,IAAP,aAAOA,IAAP,uBAAOA,IAAI,CAAEK,WAAb;AACD,C,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import \"isomorphic-unfetch\";\n\nconst API_URL = \"https://graphql.datocms.com\";\nconst API_TOKEN = process.env.NEXT_EXAMPLE_CMS_DATOCMS_API_TOKEN;\n\n// See: https://www.datocms.com/blog/offer-responsive-progressive-lqip-images-in-2020\nconst RESPONSIVE_IMAGE_FRAGMENT = `\n  height\n  sizes\n  src\n  srcSet\n  width\n  alt\n  title\n`;\n\nconst META_TAGS_FRAGMENT = `\n  attributes\n  content\n  tag\n`;\n\nasync function fetchAPI(query, { variables, preview } = {}) {\n  console.log(query, variables);\n  const res = await fetch(API_URL + (preview ? \"/preview\" : \"\"), {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${API_TOKEN}`\n    },\n    body: JSON.stringify({\n      query,\n      variables\n    })\n  });\n\n  const json = await res.json();\n  if (json.errors) {\n    console.error(json.errors);\n    throw new Error(\"Failed to fetch API\");\n  }\n  return json.data;\n}\n\nexport async function getPostDataById(id) {\n  const query = `\n    query PostById($id: ItemId) {\n      article(filter: {id: {eq: $id}}) {\n        createdAt\n        content {\n          ... on PostRecord {\n            id\n            title\n            slug\n            author\n            postContent(markdown: true)\n            excerpt\n            tableOfContents\n            createdAt\n            coverImage {\n              responsiveImage(imgixParams: { fit: crop, ar: \"16:9\", w: 750 }) {\n                ${RESPONSIVE_IMAGE_FRAGMENT}\n              }\n            }\n          }\n        }\n      }\n    }`;\n  const data = await fetchAPI(query, {\n    variables: {\n      id\n    }\n  });\n\n  return data?.article;\n}\n\nexport async function getAllPostsWithId() {\n  const data = await fetchAPI(`\n    {\n      allArticles {\n        content {\n          id\n        }\n      }\n    }\n  `);\n\n  return data?.allArticles;\n}\n\nexport async function getAllPostsForHome(preview) {\n  const data = await fetchAPI(\n    `\n    {\n      allArticles {\n        content {\n          ... on PostRecord {\n            id\n            title\n            slug\n            author\n            postContent(markdown: true)\n            excerpt\n            tableOfContents\n            createdAt\n            coverImage {\n              responsiveImage(imgixParams: { fit: crop, ar: \"16:9\", w: 750 }) {\n                ${RESPONSIVE_IMAGE_FRAGMENT}\n              }\n            }\n          }\n        }\n      }\n    }\n  `\n  );\n\n  return data?.allArticles;\n}\n\n// export async function getPostAndMorePosts(slug, preview) {\n//   const data = await fetchAPI(\n//     `\n//   query PostBySlug($slug: String) {\n//     post(filter: {slug: {eq: $slug}}) {\n//       title\n//       slug\n//       content\n//       date\n//       ogImage: coverImage{\n//         url(imgixParams: {fm: jpg, fit: crop, w: 2000, h: 1000 })\n//       }\n//       coverImage {\n//         responsiveImage(imgixParams: {fm: jpg, fit: crop, w: 2000, h: 1000 }) {\n//           ...responsiveImageFragment\n//         }\n//       }\n//       author {\n//         name\n//         picture {\n//           url(imgixParams: {fm: jpg, fit: crop, w: 100, h: 100, sat: -100})\n//         }\n//       }\n//     }\n\n//     morePosts: allPosts(orderBy: date_DESC, first: 2, filter: {slug: {neq: $slug}}) {\n//       title\n//       slug\n//       excerpt\n//       date\n//       coverImage {\n//         responsiveImage(imgixParams: {fm: jpg, fit: crop, w: 2000, h: 1000 }) {\n//           ...responsiveImageFragment\n//         }\n//       }\n//       author {\n//         name\n//         picture {\n//           url(imgixParams: {fm: jpg, fit: crop, w: 100, h: 100, sat: -100})\n//         }\n//       }\n//     }\n//   }\n\n//   ${RESPONSIVE_IMAGE_FRAGMENT}\n//   `,\n//     {\n//       preview,\n//       variables: {\n//         slug\n//       }\n//     }\n//   );\n//   return data;\n// }\n"]},"metadata":{},"sourceType":"module"}